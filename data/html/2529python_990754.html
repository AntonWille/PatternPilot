 <h2> Title: How to leave/exit/deactivate a Python virtualenv </h2> <h3> Apreche, question_id: 990754 </h3>Score: 2529, Tags: {python,virtualenv,exit,virtualenvwrapper} <br><p>I'm using virtualenv and the virtualenvwrapper. I can switch between virtualenv's just fine using the <code>workon</code> command.</p>
<pre><code>me@mymachine:~$ workon env1
(env1)me@mymachine:~$ workon env2
(env2)me@mymachine:~$ workon env1
(env1)me@mymachine:~$ 
</code></pre>
<p>How do I exit all virtual environments and work on my system environment again? Right now, the only way I have of getting back to <code>me@mymachine:~$</code> is to exit the shell and start a new one. That's kind of annoying. Is there a command to work on &quot;nothing&quot;, and if so, what is it? If such a command does not exist, how would I go about creating it?</p>
<h4> Comment 41168624 Dannid: </h4>There is a command to workon &quot;nothing&quot; - it displays all your available virtual environments, which is pretty nifty. Just type &quot;workon&quot; with no arguments and hit enter. The command to leave is &quot;deactivate&quot;, as answered below.<br><h4> Comment 118900833 Apreche: </h4>@MukeshMahadev Yes, activation is only for the current shell.<br><h4> Comment 118890984 Mukesh Mahadev: </h4>Does closing the shell deactivate all the environments used the shell session. Just wanted to get an idea if  it modifies the path env variable of the windows and just leaves it like that once the shell is closed ?<br>------------------------------------------------------------------ <br><h3> Answer 29586756 DarkRider: </h3><p>Use:</p>

<pre><code>$ deactivate 
</code></pre>

<p>If this doesn't work, try </p>

<pre><code>$ source deactivate
</code></pre>

<p>Anyone who knows how <a href="https://superuser.com/a/46146/3376">Bash <code>source</code></a> works will think that's odd, but some wrappers/workflows around virtualenv implement it as a complement/counterpart to <code>source activate</code>. Your mileage may vary.</p>
<h4> Comment 47322328 Anthon: </h4><code>deactivate</code> is a function that gets created when you source the <code>activate</code> file. Your suggestion to do <code>source deactivate</code> doesn&#39;t make sense at all, as there is no file named <code>deactivate</code><br><h4> Comment 55173311 Doug Bradshaw: </h4>This doesn&#39;t deserve the downvotes.  See edit of selected response: source deactivate is for the anaconda environment.<br><h4> Comment 72828644 Bruno Bronosky: </h4>It &quot;deserves&quot; downvotes for not meeting the SO <b>answer</b> quality standards. It&#39;s more of a comment than an answer. But, because of the 79 reputation of the poster, we should be nice and give good feedback.<br><h4> Comment 72828996 Bruno Bronosky: </h4>@Abdul I have demonstrated how you can improve your answer quality in Revision 2 at <a href="http://stackoverflow.com/posts/29586756/revisions">stackoverflow.com/posts/29586756/revisions</a><br><h4> Comment 85051192 bgenchel: </h4>this is very unhelpful if you don&#39;t have a deactivate command in your shell. I don&#39;t really understand why this would help the problem. There is no deactivate script in the virtual env.<br><h4> Comment 86444747 Statham: </h4>@Anthon However, &quot;source deactivate&quot; works for me but &quot;deactivate&quot; doesn&#39;t<br><h4> Comment 86446570 Anthon: </h4>@Statham are you running that non-standard Anaconda installer?<br><h4> Comment 86469977 Statham: </h4>@Anthon yeah, I have both anaconda2 and anaconda3 on my computer, so i have to run that, and maybe that&#39;s the reason<br>------------------------------------------------------------------ <br><h3> Answer 990779 Brandon Rhodes: </h3><p>Usually, activating a virtualenv gives you a shell function named:</p>

<pre><code>$ deactivate
</code></pre>

<p>which puts things back to normal.</p>

<p>I have just looked specifically again at the code for <code>virtualenvwrapper</code>, and, yes, it too supports <code>deactivate</code> as the way to escape from all virtualenvs.</p>

<p>If you are trying to leave an <a href="https://en.wikipedia.org/wiki/Anaconda_(Python_distribution)" rel="noreferrer"><em>Anaconda</em></a> environment, the command depends upon your version of <code>conda</code>. Recent versions (like 4.6) install a <code>conda</code> function directly in your shell, in which case you run:</p>

<pre><code>conda deactivate
</code></pre>

<p>Older conda versions instead implement deactivation using a stand-alone script:</p>

<pre><code>source deactivate
</code></pre>
<h4> Comment 20625738 Brandon Rhodes: </h4>The “deactivate” command is not a binary, nor a script that you “source”; it is a shell alias that gets defined dynamically in your current shell by the “activate” script.<br><h4> Comment 34274099 FutureNerd: </h4>Guess what the actual virtualenv command inside of &quot;workon&quot; is called? ...(spoiler warning)... ...(spoiler warning)... ...(spoiler warning)... ...(spoiler warning)... activate!<br><h4> Comment 24869465 kkurian: </h4>Would be much more intuitive if it were called &quot;workoff&quot; or &quot;unworkon&quot;. Or if &quot;workon&quot; were called &quot;activate&quot;. Thank goodness for alias.<br><h4> Comment 25238729 Brandon Rhodes: </h4>@kkurian — you should suggest that on the issue tracker for <code>virtualenvwrapper</code> and maybe Doug Hellmann would consider it! Note, for those who might read these comments later, that <code>workon</code> is <b>NOT</b> a native <code>virtualenv</code> command (which is what the original question is about) but a <code>virtualenvwrapper</code> command!<br><h4> Comment 21791110 gertvdijk: </h4>@Apreche In the meantime (almost four years later) this appears to have been <a href="http://virtualenvwrapper.readthedocs.org/en/latest/command_ref.html#deactivate" rel="nofollow noreferrer">added</a> to the documentation.<br><h4> Comment 127443345 Snowcrash: </h4>What a f**cked up way of doing things!! Why is Python deciding that the word <code>deactivate</code> only belongs to it?<br><h4> Comment 27817400 igor: </h4>@BrandonRhodes to be exact, it is not an alias, it&#39;s a function<br><h4> Comment 131492839 Snowcrash: </h4>Groan again. The second time I&#39;ve encountered this.<br>------------------------------------------------------------------ <br><h3> Answer 27947686 Bob Stein: </h3><p>I defined an <a href="https://askubuntu.com/questions/17536/how-do-i-create-a-permanent-bash-alias">alias</a>, <strong>workoff</strong>, as the opposite of <strong>workon</strong>:</p>

<pre><code>alias workoff='deactivate'
</code></pre>

<p>It is easy to remember:</p>

<pre><code>[bobstein@host ~]$ workon django_project
(django_project)[bobstein@host ~]$ workoff
[bobstein@host ~]$
</code></pre>
<h4> Comment 66917379 C0deH4cker: </h4>I like this alias. Reminds me of the Karate Kid (waxon; waxoff)<br><h4> Comment 49489425 seyed: </h4>In which file? <code>.bashrc</code>?<br><h4> Comment 104038003 pooley1994: </h4>@C0deH4cker: I signed into SO and came back to this question just to +1 your comment :p<br><h4> Comment 49492855 Bob Stein: </h4>@seyed yes, see <a href="http://askubuntu.com/a/17538/215820">this answer</a> for an example of alias in <code>~&#47;.bashrc</code><br>------------------------------------------------------------------ <br><h3> Answer 33932473 Amitesh Ranjan: </h3><p>To activate a Python virtual environment:</p>

<pre><code>$cd ~/python-venv/
$./bin/activate
</code></pre>

<p>To deactivate:</p>

<pre><code>$deactivate
</code></pre>
<h4> Comment 70355836 Corey Goldberg: </h4>&quot;source&quot; is the same as the  &quot;.&quot; command.. either can be used to source a file<br><h4> Comment 55969191 Eric Milliot-Martinez: </h4>In terminal on OS X10.11.1, I seem to have to use: <code>$source activate</code><br><h4> Comment 56721996 uchuugaka: </h4>I didn&#39;t need source. I did <code>$cd &#47;to&#47;dir&#47;i&#47;want&#47;my&#47;virtualenv&#47;installed</code> then <code>$virtualenv name_i_want_for_it</code> then <code>$. name_i_want_for_it&#47;bin&#47;activate</code> virtualenv still seems a bit off to me. Needs to be improved...<br>------------------------------------------------------------------ <br><h3> Answer 68489809 kyrlon: </h3><p>Running <code>deactivate [name of your environment]</code> is able to exit/deactivate from your python environment.</p>
<p>Example with python3.6 Windows 10 in PowerShell:</p>
<pre><code>PS C:\Users\kyrlon\Desktop&gt; py -m venv env1
PS C:\Users\kyrlon\Desktop&gt; .\env1\Scripts\activate
(env1) PS C:\Users\kyrlon\Desktop&gt; deactivate env1
PS C:\Users\kyrlon\Desktop&gt; py -m venv env1
</code></pre>
<p>Example with python3.9 on Linux Ubuntu 20.04 LTS Desktop:</p>
<pre><code>kyrlon@pc1:~$ python3 -m venv venv1
kyrlon@pc1:~$ source venv1/bin/activate
(venv1) kyrlon@pc1:~$ deactivate venv1
kyrlon@pc1:~$
</code></pre>
<h4> Comment 135740960 Ahmad Bilal: </h4>I had a curious situation where I couldn&#39;t deactivate, so solution wise I just closed the terminal in that situation. However, thanks for mentioning that explicitly naming the python venv also works. I don&#39;t if it would have worked, since I can&#39;t reproduce the original issue, but I just tested that this works on its own on Python 3.11 as well<br>------------------------------------------------------------------ <br><h3> Answer 76536445 user51: </h3><p>In MacOs ventura -</p>
<p>to activate -</p>
<pre class="lang-bash prettyprint-override"><code> sudo chmod -R 755  ./venv/bin
 source venv/bin/activate    
</code></pre>
<p>to deactivate -</p>
<pre class="lang-bash prettyprint-override"><code>deactivate
</code></pre>
------------------------------------------------------------------ <br><h3> Answer 55817628 CephBirk: </h3><p>I found that when within a Miniconda3 environment I had to run:</p>

<pre><code>conda deactivate
</code></pre>

<p>Neither <code>deactivate</code> nor <code>source deactivate</code> worked for me.</p>
<h4> Comment 106497350 Tomasz Gandor: </h4><code>deactivate</code> was for <code>virtualenv</code>, and <code>source deactivate</code> is for old conda on Linux. <code>conda deactivate</code> is a good cross-platform way for conda envs (not virtualenvs)<br>------------------------------------------------------------------ <br><h3> Answer 39263132 levi: </h3><p>You can use <code>virtualenvwrapper</code> in order to ease the way you work with <code>virtualenv</code>.</p>

<p>Installing <code>virtualenvwrapper</code>:</p>

<pre><code>pip install virtualenvwrapper
</code></pre>

<p>If you are using a standard shell, open your <code>~/.bashrc</code> or <code>~/.zshrc</code> if you use <a href="https://en.wikipedia.org/wiki/Z_shell#Oh_My_Zsh" rel="noreferrer">Oh My Zsh</a>. Add these two lines:</p>

<pre><code>export WORKON_HOME=$HOME/.virtualenvs
source /usr/local/bin/virtualenvwrapper.sh
</code></pre>

<p>To activate an existing virtualenv, use command <code>workon</code>:</p>

<pre><code>$ workon myenv
(myenv)$
</code></pre>

<p>In order to deactivate your virtualenv:</p>

<pre><code>(myenv)$ deactivate
</code></pre>

<p>Here is <a href="http://levipy.com/virtualenv-and-virtualenvwrapper-tutorial/" rel="noreferrer">my tutorial</a>, step by step on how to install virtualenv and virtualenvwrapper.</p>
<h4> Comment 66105782 Nam G VU: </h4>I see little difference compared to built-in virtualenv<br><h4> Comment 66779329 igauravsehrawat: </h4>@NamGVU Notice the <code>workon</code> command, it works from any directory.<br><h4> Comment 96507360 Mariano Ruiz: </h4>As mentioned in another post&#39;s comment (and Stackoverflow doesn&#39;t have a practical way to point to it) you cannot use <code>deactivate</code> in a shell script without first sourcing the script that defines this function (in that case you will have that <i>command not found...</i> error)<br><h4> Comment 130774830 ppuschmann: </h4>@levi I think it is &quot;deactivate myenv&quot; instead (not simple &quot;deactivate&quot;)<br>------------------------------------------------------------------ <br><h3> Answer 60290564 Will Chen: </h3><p><strong>Using the <code>deactivate</code> feature provided by the venv's <code>activate</code> script requires you to trust the deactivation function to be properly coded</strong> to cleanly reset all environment variables back to how they were before— taking into account not only the <em>original activation</em>, but also any <em>switches</em>, <em>configuration</em>, or <em>other work</em> you may have done in the meantime.</p>

<p>It's probably fine, but it does introduce a new, non-zero risk of leaving your environment modified afterwards.</p>

<p>However, it's not technically possible for a process to directly alter the environment variables of its parent, <strong>so we can use a separate sub-shell to be absolutely sure</strong> our <code>venv</code>s don't leave any residual changes behind:</p>

<hr>

<h2>To activate:</h2>

<p><code>$ bash --init-file PythonVenv/bin/activate</code></p>

<ul>
<li>This starts a new shell around the <code>venv</code>. Your original <code>bash</code> shell remains unmodified.</li>
</ul>

<h2>To deactivate:</h2>

<p><code>$ exit</code> OR <code>[CTRL]</code>+<code>[D]</code></p>

<ul>
<li>This exits the entire shell the <code>venv</code> is in, and drops you back to the original shell from before the activation script made any changes to the environment.</li>
</ul>

<hr>

<h2>Example:</h2>

<pre><code>[user@computer ~]$ echo $VIRTUAL_ENV
No virtualenv!

[user@computer ~]$ bash --init-file PythonVenv/bin/activate

(PythonVenv) [user@computer ~]$ echo $VIRTUAL_ENV
/home/user/PythonVenv

(PythonVenv) [user@computer ~]$ exit
exit

[user@computer ~]$ echo $VIRTUAL_ENV
No virtualenv!
</code></pre>
------------------------------------------------------------------ <br><h3> Answer 66699840 Nick.Mc: </h3><p>For my particular case, I go to to the working directory</p>
<pre><code>CD /myworkingdirectory
</code></pre>
<p>Then I activate my env like this:</p>
<pre><code>my-env/scripts/activate
</code></pre>
<p>From this same working folder (<code>/myworkingdirectory</code>) to deactivate, I tried this but it does nothing:</p>
<pre><code>my-env/scripts/deactivate
</code></pre>
<p>This does work:</p>
<pre><code>deactivate
</code></pre>
------------------------------------------------------------------ <br><h3> Answer 72948470 L&#233;o: </h3><p><code>$ conda deactivate</code> <br>or<br> <code>$ source deactivate</code>
<br>would work. <br><br> If it doesn't work, try <code>deactivate [name of your environment]</code> instead.</p>
<h4> Comment 132906853 Jalil Nourmohammadi Khiarak: </h4>For me deactivate [name of my env] worked.<br>------------------------------------------------------------------ <br><h3> Answer 57342256 DocSalvager: </h3><p>Since the <code>deactivate</code> function created by sourcing <code>~/bin/activate</code> cannot be discovered by the usual means of looking for such a command in <code>~/bin</code>, you may wish to create one that just executes the function <code>deactivate</code>.</p>

<p>The problem is that a script named <code>deactivate</code> containing a single command <code>deactivate</code> will cause an endless loop if accidentally executed while not in the venv. A common mistake.</p>

<p>This can be avoided by only executing <code>deactivate</code> if the function exists (i.e. has been created by sourcing <code>activate</code>).</p>

<pre><code>#!/bin/bash

declare -Ff deactivate  &amp;&amp; deactivate
</code></pre>
------------------------------------------------------------------ <br><h3> Answer 42224204 Sardathrion - against SE abuse: </h3><p>I use <a href="https://github.com/Tarrasch/zsh-autoenv" rel="nofollow noreferrer">zsh-autoenv</a> which is based off <a href="https://github.com/kennethreitz/autoenv" rel="nofollow noreferrer">autoenv</a>. </p>

<blockquote>
  <p><a href="https://github.com/Tarrasch/zsh-autoenv" rel="nofollow noreferrer">zsh-autoenv</a> automatically
  sources (known/whitelisted) <code>.autoenv.zsh</code> files, typically used in
  project root directories. It handles "enter" and leave" events,
  nesting, and stashing of variables (overwriting and restoring).</p>
</blockquote>

<p>Here is an example:</p>

<pre><code>; cd dtree 
Switching to virtual environment: Development tree utiles
;dtree(feature/task24|✓); cat .autoenv.zsh       
# Autoenv.
echo -n "Switching to virtual environment: "
printf "\e[38;5;93m%s\e[0m\n" "Development tree utiles"
workon dtree
# eof
dtree(feature/task24|✓); cat .autoenv_leave.zsh 
deactivate
</code></pre>

<p>So when I leave the <code>dtree</code> directory, the virtual environment is automatically exited.</p>

<p><code>"Development tree utiles"</code> is just a name… No hidden mean linking to the Illuminati in here.</p>
------------------------------------------------------------------ <br><h3> Answer 70531144 C-Bizz: </h3><p>I my case, I was able to activate virtual environment using <code>env-name\scripts\activate</code> and deactivate it using <code>deactivate</code>. However, after running update on my windows PC <code>deactivate</code> was no longer recognized as an internal or external command. What I used from that moment onward is <code>env-name\scripts\deactivate</code> and that solved the problem.</p>
------------------------------------------------------------------ <br><h3> Answer 27429748 Lord Sumner: </h3><p>I had the same problem while working on an installer script. I took a look at what the <em>bin/activate_this.py</em> did and reversed it.</p>

<p>Example:</p>

<pre><code>#! /usr/bin/python
# -*- coding: utf-8 -*-
import os
import sys

# Path to virtualenv
venv_path = os.path.join('/home', 'sixdays', '.virtualenvs', 'test32')

# Save old values
old_os_path = os.environ['PATH']
old_sys_path = list(sys.path)
old_sys_prefix = sys.prefix


def deactivate():
    # Change back by setting values to starting values
    os.environ['PATH'] = old_os_path
    sys.prefix = old_sys_prefix
    sys.path[:0] = old_sys_path


# Activate the virtualenvironment
activate_this = os.path.join(venv_path, 'bin/activate_this.py')
execfile(activate_this, dict(__file__=activate_this))


# Print list of pip packages for virtualenv for example purpose
import pip
print str(pip.get_installed_distributions())

# Unload pip module
del pip

# Deactivate/switch back to initial interpreter
deactivate()

# Print list of initial environment pip packages for example purpose
import pip
print str(pip.get_installed_distributions())
</code></pre>

<p>I am not 100% sure if it works as intended. I may have missed something completely.</p>
<h4> Comment 62784120 Ramkumar D: </h4>if deactivate resets value of environment path, system path, default prompt then your deactivate function is good approach. I like your script. Already given +1.<br>------------------------------------------------------------------ <br><h3> Answer 76217674 VojtaK: </h3><p>If you don't know how to exit some python environment I would just run</p>
<pre><code>bash --norc
</code></pre>
<p>as there is a risk you missed deleting that code for entering to some python environment, which something such as conda/mamba already installed  into your <code>.bashrc</code> The conda/mamba enters environments the same way you can run bash inside bash. Default installation forces base environment to be activated by default, which drives me crazy as it might break lot of things, to exit it you just type</p>
<pre><code>mamba deactivate
</code></pre>
<p>But you can configure conda in a way that you activate it only when you use it. Then if you e.g. type</p>
<pre><code>mamba activate env
(env)mamba activate base
(base)mamba activate base
(base)mamba activate xy
</code></pre>
<p>You will actually be in nested environment <code>(xy)</code> and  <code>(xy) -deactivate-&gt; (base) -deactivate-&gt; (base) -deactivate-&gt; (env) -deactivate-&gt; no conda/mamba</code>.</p>
<p>So if you are in some environment, do not know how much nested it is and you want to get base environment, you can also use</p>
<pre><code>mamba activate base
</code></pre>
