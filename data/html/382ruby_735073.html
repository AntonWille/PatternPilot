 <h2> Title: Best way to require all files from a directory in ruby? </h2> <h4> Gaetan Dubar, question_id: 735073, created_at: 2009-04-09 17:00:15+00:00 </h4>Score: 382, Tags: {ruby,file,directory,require} <br><p>What's the best way to require all files from a directory in ruby ?</p>
<hr><h3>  Answer by jandot, Id: 735458, Score: 365, created_at: 2009-04-09 18:50:45+00:00 </h3><p>If it's a directory relative to the file that does the requiring (e.g. you want to load all files in the lib directory):</p>

<pre><code>Dir[File.dirname(__FILE__) + '/lib/*.rb'].each {|file| require file }
</code></pre>

<p><strong>Edit:</strong> Based on comments below, an updated version:</p>

<pre><code>Dir[File.join(__dir__, 'lib', '*.rb')].each { |file| require file }
</code></pre>
<h4> Comment by Chris, Score: 64, Id: 14982729, created_at: 2012-07-06 23:22:14+00:00 </h4>It&#39;s probably safer to use File.join rather than making assumptions about forward/backward slashes: <code>Dir[File.join(File.dirname(__FILE__), &#39;lib&#39;, &#39;*.rb&#39;)].each {|file| require file }</code><h4> Comment by Christian Bankester, Score: 30, Id: 35848552, created_at: 2014-04-30 21:05:44+00:00 </h4>If you&#39;re using &gt;= ruby 2.0, you can use <code>__dir__</code> instead of <code>File.dirname(__FILE__)</code>.<h4> Comment by jspooner, Score: 15, Id: 14954104, created_at: 2012-07-05 23:18:40+00:00 </h4>You can also add all child directories like this <code>Dir[File.dirname(__FILE__) + &#39;&#47;support&#47;**&#47;*.rb&#39;].each {|file| require file }</code><h4> Comment by maasha, Score: 6, Id: 33129595, created_at: 2014-02-19 12:28:21+00:00 </h4>There is also require_relative<h4> Comment by David Moles, Score: 5, Id: 46446683, created_at: 2015-03-17 19:59:35+00:00 </h4>@maasha How do you use <code>require_relative</code> to require all files in a directory?<h4> Comment by grasingerm, Score: 0, Id: 17540629, created_at: 2012-10-17 18:59:06+00:00 </h4>@ChristopherPatuzzo you are a live saver. I couldn&#39;t figure out why the files were never loaded. &quot;\current\file\path/lib/*.rb&quot;<hr><h3> ✔️ Answer by Sam Stokes, Id: 735130, Score: 501, created_at: 2009-04-09 17:19:59+00:00 </h3><p>How about:</p>

<pre><code>Dir["/path/to/directory/*.rb"].each {|file| require file }
</code></pre>
<h4> Comment by Sam Stokes, Score: 20, Id: 546604, created_at: 2009-04-09 17:46:34+00:00 </h4>According to the Pickaxe, the .rb extension is optional.  Technically it changes the meaning: &quot;require &#39;foo.rb&#39;&quot; requires foo.rb, whereas &quot;require &#39;foo&#39;&quot; might require foo.rb, foo.so or foo.dll.<h4> Comment by sheldonh, Score: 12, Id: 45714849, created_at: 2015-02-25 07:32:13+00:00 </h4>@PeteHodgson&#39;s suggestion is inaccurate. Ruby&#39;s <code>require</code> is not confused by the presence or absence of the <code>.rb</code> extension. Tested on MRI 1.8.7-p374, 2.1.5 and 2.2.0 tested. This urban legend comes from Rails, where &quot;clever&quot; autoloading exhibited the behaviour he describes in older versions (and may still exhibit it).<h4> Comment by Andres Riofrio, Score: 5, Id: 13072703, created_at: 2012-04-17 04:05:16+00:00 </h4>@Pete, is this still true? See <a href="http://stackoverflow.com/questions/735073/best-way-to-require-all-files-from-a-directory-in-ruby#comment9237243_2231511">Rene&#39;s comment</a> below.<h4> Comment by user2398029, Score: 5, Id: 14499507, created_at: 2012-06-18 02:53:12+00:00 </h4>This might be obvious, but its worth noting that dropping the .rb will also require any non-.rb files in the dir, which might not be desired.<h4> Comment by rampion, Score: 3, Id: 546518, created_at: 2009-04-09 17:27:08+00:00 </h4>You&#39;ll need to drop the .rb before requiring.  Good other than that<h4> Comment by RngTng, Score: 2, Id: 60199834, created_at: 2016-03-29 14:23:00+00:00 </h4>make sure to sort files first, for not introducing randomness caused by OS and keep require order deterministic:  <code>Dir[&quot;&#47;path&#47;to&#47;directory&#47;*.rb&quot;].sort.each {|file| require file }</code><h4> Comment by Adverbly, Score: 0, Id: 96098896, created_at: 2019-02-12 15:37:06+00:00 </h4>even more concise would be:           <code>Dir[&quot;&#47;path&#47;to&#47;directory&#47;*.rb&quot;].each(&amp;method(:require))</code><h4> Comment by JacobEvelyn, Score: 0, Id: 32978410, created_at: 2014-02-15 08:23:47+00:00 </h4>@louism I think the discussion is actually about dropping the <code>.rb</code> from the <code>require</code> portion: <code>Dir[&quot;&#47;path&#47;to&#47;directory&#47;*.rb&quot;].each {|file| require file[0..-4] }</code><hr><h3>  Answer by Tony Arcieri, Id: 992140, Score: 108, created_at: 2009-06-14 04:08:58+00:00 </h3><p>Try the require_all gem:</p>

<ol>
<li><a href="http://github.com/jarmo/require_all" rel="noreferrer">http://github.com/jarmo/require_all</a></li>
<li><a href="https://rubygems.org/gems/require_all" rel="noreferrer">https://rubygems.org/gems/require_all</a></li>
</ol>

<p>It lets you simply:</p>

<pre><code>require_all 'path/to/directory'
</code></pre>
<h4> Comment by Pere Joan Martorell, Score: 7, Id: 97088676, created_at: 2019-03-15 03:03:55+00:00 </h4>It doesn&#39;t have sense to bloat your app with gems that you can simply replace with a line of code. This increases the load time of your app and induces more bugs at long term.<h4> Comment by sheldonh, Score: 3, Id: 45714967, created_at: 2015-02-25 07:36:03+00:00 </h4>@panupan Just be aware that <code>require_all</code>&#39;s cyclic dependency resolution works around a problem in your source code: you have Ruby source files that do not require their dependencies. This shuts the door on scalpel loading, committing you to all-or-nothing loading. That&#39;s not a problem in small libraries, but it&#39;s a decision you should be making consciously.<h4> Comment by panupan, Score: 0, Id: 10386072, created_at: 2011-12-07 01:39:29+00:00 </h4>I needed to include all of my ActiveRecord models, the require_all gem figured out all of the dependencies and required them perfectly. Thanks!<hr><h3>  Answer by magicgregz, Id: 21693468, Score: 49, created_at: 2014-02-11 04:56:29+00:00 </h3><pre><code>Dir.glob(File.join('path', '**', '*.rb'), &amp;method(:require))
</code></pre>

<p>or alternatively, if you want to scope the files to load to specific folders:</p>

<pre><code>Dir.glob(File.join('path', '{folder1,folder2}', '**', '*.rb'), &amp;method(:require))
</code></pre>

<p><strong>explanation:</strong> </p>

<p><a href="http://ruby-doc.org/core-2.2.0/Dir.html#method-c-glob">Dir.glob</a> takes a block as argument.</p>

<p>method(:require) <a href="http://ruby-doc.org/core-1.9.3/Object.html#method-i-method">will return the require method.</a></p>

<p>&amp;method(:require) will convert the method to a bloc.</p>
<h4> Comment by Nate Symer, Score: 2, Id: 35725746, created_at: 2014-04-28 01:39:24+00:00 </h4>This is some beautiful code. I love how there are no visible blocks.<h4> Comment by Ivan Black, Score: 1, Id: 38265287, created_at: 2014-07-10 14:55:46+00:00 </h4><code>Dir.glob( File.join( File.dirname(__FILE__), &#39;{lib,addons}&#39;, &#39;subfolder&#39;, &#39;**&#39;, &#39;*.rb&#39; ), &amp;method(:require) )</code> eliminates dependence on platform (such as &#39;/&#39; or &#39;\&#39;). Works well. Thanks.<hr><h3>  Answer by Pete Hodgson, Id: 2231511, Score: 53, created_at: 2010-02-09 18:38:29+00:00 </h3><pre><code>Dir[File.dirname(__FILE__) + '/../lib/*.rb'].each do |file| 
  require File.basename(file, File.extname(file))
end
</code></pre>

<p>If you don't strip the extension then you may end up requiring the same file twice (ruby won't realize that "foo" and "foo.rb" are the same file). Requiring the same file twice can lead to spurious warnings (e.g. "warning: already initialized constant").</p>
<h4> Comment by Rene Saarsoo, Score: 15, Id: 9237243, created_at: 2011-09-30 14:06:10+00:00 </h4>My testing shows the same that Derek said: <code>require &quot;foo.rb&quot;; require &quot;foo&quot;;</code> will load <code>foo.rb</code> just once.<h4> Comment by Derek, Score: 11, Id: 5370795, created_at: 2011-01-29 17:47:18+00:00 </h4>Is this really the case? Documentation says: A feature will not be loaded if its name already appears in $&quot;. The file name is converted to an absolute path, so &quot;require &#39;a&#39;; require &#39;./a&#39;&quot; will not load a.rb twice. <a href="http://www.ruby-doc.org/core/classes/Kernel.html#M001418" rel="nofollow noreferrer">ruby-doc.org/core/classes/Kernel.html#M001418</a><h4> Comment by sheldonh, Score: 5, Id: 45714865, created_at: 2015-02-25 07:32:55+00:00 </h4>No. Ruby&#39;s <code>require</code> is not confused by the presence or absence of the <code>.rb</code> extension. Tested on MRI 1.8.7-p374, 2.1.5 and 2.2.0. This urban legend comes from Rails, where &quot;clever&quot; autoloading exhibited the behaviour described in older versions (and may still exhibit it).<h4> Comment by Yarin, Score: 1, Id: 29275195, created_at: 2013-10-31 13:31:32+00:00 </h4>@PeteHodgson- Can you back this up?<hr><h3>  Answer by Ryan McGeary, Id: 736237, Score: 36, created_at: 2009-04-09 23:28:14+00:00 </h3><p>The best way is to add the directory to the load path and then <code>require</code> the basename of each file.  This is because you want to avoid accidentally requiring the same file twice -- often  not the intended behavior.  Whether a file will be loaded or not is dependent on whether <code>require</code> has seen the path passed to it before.  For example, this simple irb session shows that you can mistakenly require and load the same file twice.</p>

<pre><code>$ irb
irb(main):001:0&gt; require 'test'
=&gt; true
irb(main):002:0&gt; require './test'
=&gt; true
irb(main):003:0&gt; require './test.rb'
=&gt; false
irb(main):004:0&gt; require 'test'
=&gt; false
</code></pre>

<p>Note that the first two lines return <code>true</code> meaning the same file was loaded both times.  When paths are used, even if the paths point to the same location, <code>require</code> doesn't know that the file was already required.</p>

<p>Here instead, we add a directory to the load path and then require the basename of each *.rb file within.</p>

<pre><code>dir = "/path/to/directory"
$LOAD_PATH.unshift(dir)
Dir[File.join(dir, "*.rb")].each {|file| require File.basename(file) }
</code></pre>

<p>If you don't care about the file being required more than once, or your intention is just to load the contents of the file, perhaps <code>load</code> should be used instead of <code>require</code>.  Use load in this case, because it better expresses what you're trying to accomplish.  For example:</p>

<pre><code>Dir["/path/to/directory/*.rb"].each {|file| load file }
</code></pre>
<h4> Comment by Mayinx, Score: 1, Id: 113648467, created_at: 2020-10-08 19:29:41+00:00 </h4>This seems to be the best solution to require all files while avoiding any accidental double requiring of files - and should be marked as the accepted answer ...<h4> Comment by Nakilon, Score: 0, Id: 123987893, created_at: 2021-11-28 02:34:34+00:00 </h4>I feel like something has changed since 2009. <code>require</code> now needs <code>.&#47;</code> and <code>require_relative</code> realises those are paths to the same file.<hr><h3>  Answer by user470069, Id: 6400831, Score: 17, created_at: 2011-06-19 05:53:06+00:00 </h3><pre><code>Dir[File.join(__dir__, "/app/**/*.rb")].each do |file|
  require file
end
</code></pre>

<p>This will work recursively on your local machine and a remote (Like Heroku) which does not use relative paths.</p>
<hr><h3>  Answer by Koen., Id: 21851294, Score: 17, created_at: 2014-02-18 10:42:54+00:00 </h3><p>Instead of concatenating paths like in some answers, I use <code>File.expand_path</code>:</p>

<pre><code>Dir[File.expand_path('importers/*.rb', File.dirname(__FILE__))].each do |file|
  require file
end
</code></pre>

<p><strong>Update:</strong></p>

<p>Instead of using <code>File.dirname</code> you could do the following:</p>

<pre><code>Dir[File.expand_path('../importers/*.rb', __FILE__)].each do |file|
  require file
end
</code></pre>

<p>Where <code>..</code> strips the filename of <code>__FILE__</code>.</p>
<h4> Comment by mswieboda, Score: 0, Id: 36887872, created_at: 2014-05-30 04:26:25+00:00 </h4>this seems definitely the way to go, and most up to date answer, after trying all the rest, +1 for <code>File.expand_path</code><h4> Comment by nzifnab, Score: 0, Id: 41133467, created_at: 2014-10-06 23:05:34+00:00 </h4>I definitely prefer this answer to the accepted one.  Various <code>Rails.root.join</code> answers also work if you&#39;re in rails.<hr><h3>  Answer by Dan Kohn, Id: 26048097, Score: 8, created_at: 2014-09-25 21:06:35+00:00 </h3><p>In Rails, you can do:</p>

<pre><code>Dir[Rails.root.join('lib', 'ext', '*.rb')].each { |file| require file }
</code></pre>

<p>Update: Corrected with suggestion of @Jiggneshh Gohel to remove slashes.</p>
<h4> Comment by DMKE, Score: 0, Id: 40807219, created_at: 2014-09-25 22:00:53+00:00 </h4>Since <code>Rails.root</code> is a <a href="http://ruby-doc.org/stdlib/libdoc/pathname/rdoc/index.html" rel="nofollow noreferrer"><code>Pathname</code></a> instance, you can do this in any Ruby environment, not just Rails (N.B. <code>Rails.root.join(&#39;lib&#47;ext&#47;*.rb&#39;)</code> reads a little nicer)<h4> Comment by Dan Kohn, Score: 0, Id: 40811324, created_at: 2014-09-26 02:24:41+00:00 </h4>Thanks for the recommendation; I edited to include your comment.<h4> Comment by Jignesh Gohel, Score: 0, Id: 50917388, created_at: 2015-07-17 12:46:05+00:00 </h4>Using a forward slash (/) for sub-directories under Rails.root, for e.g. <code>Rails.root.join(&#39;&#47;lib&#39;)</code> doesn&#39;t generate correct path. I found this one to work correctly: <code>Dir[Rails.root.join(&#39;lib&#39;, &#39;ext&#39;, &#39;*.rb&#39;)].each { |file| require file }</code><h4> Comment by Dan Kohn, Score: 0, Id: 54839705, created_at: 2015-11-04 18:14:41+00:00 </h4>@Jiggneshh Gohel I removed slashes as you suggested, thanks.<hr><h3>  Answer by Jazz, Id: 24153527, Score: 3, created_at: 2014-06-11 01:57:13+00:00 </h3><p>I'm a few years late to the party, but I kind of like this one-line solution I used to get rails to include everything in app/workers/concerns:</p>

<p><code>Dir[ Rails.root.join *%w(app workers concerns *) ].each{ |f| require f }</code></p>
<hr><h3>  Answer by Mike Slinn, Id: 76043492, Score: 1, created_at: 2023-04-18 10:27:30+00:00 </h3><p>For Ruby older than 3.0, <a href="https://www.rubydoc.info/gems/rubocop/RuboCop/Cop/Lint/NonDeterministicRequireOrder" rel="nofollow noreferrer">Rubocop warns</a> against the accepted answer because load order is not deterministic for all OSes. Linux sorts upper and lower case differently than Mac or Windows. The following does what the OP requested for all versions of Ruby:</p>
<pre class="lang-rb prettyprint-override"><code>Dir['/path/to/directory/*.rb'].sort.each { |file| require file }
</code></pre>
<p>The following recurses through all subdirectories for all versions of Ruby:</p>
<pre class="lang-rb prettyprint-override"><code>Dir['/path/to/directory/**/*.rb'].sort.each { |file| require file }
</code></pre>
<p>Ruby 3.0 and later sort files consistently, so the following is all that is needed if you know that older Ruby versions will never be used:</p>
<pre class="lang-rb prettyprint-override"><code>Dir['/path/to/directory/*.rb'].each { |file| require file }
</code></pre>
<p>The following recurses through all subdirectories for Ruby 3.0 and later:</p>
<pre class="lang-rb prettyprint-override"><code>Dir['/path/to/directory/**/*.rb'].each { |file| require file }
</code></pre>
<hr><h3>  Answer by MGreenfield, Id: 75883224, Score: 0, created_at: 2023-03-30 00:34:09+00:00 </h3><p>All these answers are great. To add, if you want to do this automagically, you can use <a href="https://github.com/fxn/zeitwerk" rel="nofollow noreferrer">Zeitwerk</a>, which is what Rails uses to load files.</p>
<pre><code>require 'zeitwerk'
loader = Zeitwerk::Loader.new
loader.push_dir('main/src/dir')
loader.setup
</code></pre>
<p>Then everything has access to everything</p>
<hr><h3>  Answer by Aleksander, Id: 41585878, Score: -2, created_at: 2017-01-11 08:23:37+00:00 </h3><p>And what about: <code>require_relative *Dir['relative path']</code>?</p>
<h4> Comment by fabriciofreitag, Score: 1, Id: 74132444, created_at: 2017-04-21 10:30:12+00:00 </h4>Require relative doesn&#39;t take multiple files: <a href="http://ruby-doc.org/core-2.1.2/Kernel.html#method-i-require_relative" rel="nofollow noreferrer">ruby-doc.org/core-2.1.2/Kernel.html#method-i-require_relativ&zwnj;&#8203;e</a><h4> Comment by knut, Score: 1, Id: 75376064, created_at: 2017-05-25 12:53:40+00:00 </h4><i>The &#39;*&#39; changes arity to 1</i> - What do you mean with it? <code>require_relative *Dir[&#39;*.rb&#39;]</code> work, if there is only one ruby-script. But if multiple ruby scripts are found, you get <code>require_relative&#39;: wrong number of arguments (4 for 1) (ArgumentError)</code><h4> Comment by Aleksander, Score: 0, Id: 74807785, created_at: 2017-05-10 08:07:39+00:00 </h4>OK, but in my example it isn&#39;t. The &#39;*&#39; changes arity to 1. It works as multiple call to require_relative.