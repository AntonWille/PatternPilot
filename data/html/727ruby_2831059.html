 <h2> Title: How to drop columns using Rails migration </h2> <h4> Ethan, question_id: 2831059 </h4>Score: 727, Tags: {ruby-on-rails,ruby,database,activerecord,rails-migrations} <br><p>What's the syntax for dropping a database table column through a <a href="https://guides.rubyonrails.org/active_record_migrations.html" rel="noreferrer">Rails migration</a>?</p>
------------------------------------------------------------------ <br><h3> aschmid, Id: 39119073, Score: 16: </h3><p>in rails 5 you can use this command in the terminal:</p>

<pre><code>rails generate migration remove_COLUMNNAME_from_TABLENAME COLUMNNAME:DATATYPE
</code></pre>

<p>for example to remove the column access_level(string) from table users:</p>

<pre><code>rails generate migration remove_access_level_from_users access_level:string
</code></pre>

<p>and then run:</p>

<pre><code>rake db:migrate
</code></pre>
------------------------------------------------------------------ <br><h3> Nick Hammond, Id: 2963582, Score: 1059: </h3><pre><code>remove_column :table_name, :column_name
</code></pre>

<p>For instance:</p>

<pre><code>remove_column :users, :hobby
</code></pre>

<p>would remove the hobby Column from the users table.</p>
<h4> Dennis, Comment 34520136 Score: 29: </h4>In Rails4, you can remove a column in the <code>change</code> method, but only if you specify the column type. E.g. <code>remove_column, :table_name, :column_name, :column_type</code>. Otherwise you&#39;ll get the following error when trying to run the migration: <code>remove_column is only reversible if given a type</code><br><h4> Nicolas, Comment 32157077 Score: 9: </h4>You can also use <code>remove_column :table_name, :column_name, :type, :options</code> within the <code>change</code> method, since if you specify the type reverting the migration is possible. From the documentation: <i>The <code>type</code>and <code>options</code> parameters will be ignored if present. It can be helpful to provide these in a migration&#39;s <code>change</code> method so it can be reverted. In that case, <code>type</code> and <code>options</code> will be used by add_column.</i><br><h4> Powers, Comment 28434413 Score: 8: </h4>@X&#229;pplI&#39;-I0llwlg&#39;I-Thanks for the comment.  The change method can be used to drop a column in Rails 4 applications, but should not be used in Rails 3.  I updated my answer accordingly.<br><h4> sameers, Comment 42767933 Score: 6: </h4>It might be worth noting in the main answer that <a href="http://stackoverflow.com/questions/7204476/will-removing-a-column-with-a-rails-migration-remove-indexes-associated-with-the">removing a column does not remove the corresponding index if it exists</a><br>------------------------------------------------------------------ <br><h3> prabu, Id: 3742902, Score: 411: </h3><p>For older versions of Rails </p>

<pre><code>ruby script/generate migration RemoveFieldNameFromTableName field_name:datatype
</code></pre>

<p>For Rails 3 and up</p>

<pre><code>rails generate migration RemoveFieldNameFromTableName field_name:datatype
</code></pre>
<h4> Stuart Nelson, Comment 17921169 Score: 47: </h4><code>rails g migration remove_field_name_from_table_name field_name:datatype</code> also works<br><h4> Noz, Comment 16687448 Score: 21: </h4>&quot;rails g&quot; can be used as an alternative to &quot;rails generate&quot;<br><h4> Claudio Floreani, Comment 23042512 Score: 7: </h4>Note also that <code>AddXXXtoTTT</code> an <code>RemoveXXXFromTTT</code> may be followed by a white-spaced list of filed_name:data_type, and the appropriate add_column and remove_column statements will be created: <code>rails g migration RemoveUnusefulFieldsFromUsers hair_color:string favorite_number:integer</code> removes two attributes using a single migration. Note also that <code>remove_column</code> is not supported by <code>change</code> method, so you have to write both <code>up</code> and <code>down</code>.<br><h4> Unknown_Guy, Comment 28147717 Score: 3: </h4>Rails 4 seems to support <code>change</code> for this. Rollback works like it should.<br><h4> RFVoltolini, Comment 75289609 Score: 2: </h4>@AdamGrant I think that if you are using a <code>change</code> method that can be <i>reverted*</i> you&#39;ll need to inform the data type (and all other field modifiers), so if you rollback that migration, the field can be correctly recreated. <i>* When I say reverted, that&#39;s in terms of database structure, of course, data from that column obviously will be lost.</i><br><h4> opensource-developer, Comment 111332234 Score: 1: </h4>@ClaudioFloreani your comment was really helpfull, many thanks<br><h4> Adam Grant, Comment 46476178 Score: 1: </h4>I don&#39;t think you need the <code>field_name:datatype</code>. Removing is removing.<br>------------------------------------------------------------------ <br><h3> Powers, Id: 17792447, Score: 129: </h3><p>Rails 4 has been updated, so the change method can be used in the migration to drop a column and the migration will successfully rollback.  Please read the following warning for Rails 3 applications:</p>

<p><strong>Rails 3 Warning</strong></p>

<p>Please note that when you use this command:</p>

<pre><code>rails generate migration RemoveFieldNameFromTableName field_name:datatype
</code></pre>

<p>The generated migration will look something like this:</p>

<pre><code>  def up
    remove_column :table_name, :field_name
  end

  def down
    add_column :table_name, :field_name, :datatype
  end
</code></pre>

<p>Make sure to not use the change method when removing columns from a database table (example of what you don't want in the migration file in Rails 3 apps):</p>

<pre><code>  def change
    remove_column :table_name, :field_name
  end
</code></pre>

<p>The change method in Rails 3 is not smart when it comes to remove_column, so you will not be able to rollback this migration. </p>
<h4> roxdurazo, Comment 55576519 Score: 4: </h4>then run rake db:migrate<br><h4> rmcsharry, Comment 62033979 Score: 2: </h4>In Rails 4, I tried to rollback a change drop column. It fails and states you must specify data_type (as in your down code in your answer)<br><h4> BenKoshy, Comment 59927072 Score: 1: </h4>@Powers - brilliant and clear answer - would you be able to elaborate on the following: &quot;The change method in Rails 3 is not smart when it comes to remove_column, so you will not be able to rollback this migration.&quot;<br><h4> Powers, Comment 59957233 Score: 1: </h4>@BKSpurgeon - In Rails 3, if you use the <code>change</code> method, then the <code>rake db:rollback</code> command will error out.  <code>rake db:rollback</code> is basically the opposite of <code>rake db:migrate</code>.  This bug was fixed in Rails 4 :)<br><h4> M. Habib, Comment 81468226 Score: 1: </h4>Same problem occured to me as to @rmcsharry. My rails version is 4.2.2 and i used change method. when i tried to rollback, error occured that remove_column is only reversible if given a type.<br>------------------------------------------------------------------ <br><h3> superluminary, Id: 22962475, Score: 43: </h3><p>There are two good ways to do this:</p>

<h2>remove_column</h2>

<p>You can simply use remove_column, like so:</p>

<pre><code>remove_column :users, :first_name
</code></pre>

<p>This is fine if you only need to make a single change to your schema.</p>

<h2>change_table block</h2>

<p>You can also do this using a change_table block, like so:</p>

<pre><code>change_table :users do |t|
  t.remove :first_name
end
</code></pre>

<p>I prefer this as I find it more legible, and you can make several changes at once.</p>

<p>Here's the full list of supported change_table methods:</p>

<p><a href="http://apidock.com/rails/ActiveRecord/ConnectionAdapters/SchemaStatements/change_table" rel="noreferrer">http://apidock.com/rails/ActiveRecord/ConnectionAdapters/SchemaStatements/change_table</a></p>
------------------------------------------------------------------ <br><h3> Lars Schirrmeister, Id: 24664114, Score: 46: </h3><p>In a rails4 app it is possible to use the change method also for removing columns. The third param is the data_type and in the optional forth you can give options. It is a bit hidden in the section 'Available transformations' on <a href="http://api.rubyonrails.org/classes/ActiveRecord/Migration.html">the documentation</a> .</p>

<pre><code>class RemoveFieldFromTableName &lt; ActiveRecord::Migration
  def change
    remove_column :table_name, :field_name, :data_type, {}
  end
end
</code></pre>
------------------------------------------------------------------ <br><h3> BenKoshy, Id: 54301355, Score: 35: </h3><h2>Clear &amp; Simple Instructions for Rails 5 &amp; 6</h2>
<ul>
<li><strong>WARNING: You will lose data</strong>.</li>
<li>Warning: the below instructions are for trivial migrations. For complex migrations with e.g. millions of rows, read/write dbs, clusters, this advice is not for you:</li>
</ul>
<hr />
<h1>1. Create a migration</h1>
<p><strong>Run</strong> the following command in your terminal:</p>
<p><code>rails generate migration remove_fieldname_from_tablename fieldname:fieldtype</code> (Table name in plural, as per convention. <a href="https://api.rubyonrails.org/classes/ActiveRecord/Migration.html" rel="nofollow noreferrer">See the documentation here.</a> )</p>
<p><strong>Example:</strong> <code>rails g migration RemoveAcceptedFromQuotes accepted:boolean</code></p>
<h2>2. Check the migration</h2>
<pre><code># db/migrate/20190122035000_remove_accepted_from_quotes.rb
class RemoveAcceptedFromQuotes &lt; ActiveRecord::Migration[5.2]
  # with rails 5.2 you don't need to add a separate &quot;up&quot; and &quot;down&quot; method.
  def change
    remove_column :quotes, :accepted, :boolean
  end
end
</code></pre>
<h2>3. Run the migration</h2>
<p><code>rake db:migrate</code> or <code>rails db:migrate</code> (they're both the same)</p>
<p>....And then you're off to the races!</p>
<h4> Imran Ali, Comment 106410708 Score: 1: </h4>now migrations can also be run as <code>rails db:migrate</code><br>------------------------------------------------------------------ <br><h3> Imran Ahmad, Id: 47311476, Score: 20: </h3><p>Generate a migration to remove a column such that if it is migrated (<code>rake db:migrate</code>), it should <strong>drop the column</strong>. And it should <strong>add column back</strong> if this migration is rollbacked (<code>rake db:rollback</code>).</p>

<p>The syntax:</p>

<p><strong>remove_column :table_name, :column_name, :type</strong></p>

<blockquote>
  <p>Removes column, also <strong>adds column back</strong> if migration is rollbacked.</p>
</blockquote>

<p>Example: </p>

<pre><code>remove_column :users, :last_name, :string
</code></pre>

<p><strong>Note</strong>: <em>If you skip the data_type</em>, the migration will remove the column successfully but if you rollback the migration it will throw an error.</p>
------------------------------------------------------------------ <br><h3> Jordan Running, Id: 2831067, Score: 14: </h3><p>You can try the following:</p>

<pre><code>remove_column :table_name, :column_name
</code></pre>

<p>(<a href="http://apidock.com/rails/ActiveRecord/ConnectionAdapters/SchemaStatements/remove_column" rel="noreferrer">Official documentation</a>)</p>
------------------------------------------------------------------ <br><h3> XYZ, Id: 39785339, Score: 14: </h3><p><strong>Remove Columns For RAILS 5 App</strong></p>

<pre><code>rails g migration Remove&lt;Anything&gt;From&lt;TableName&gt; [columnName:type]
</code></pre>

<p>Command above generate a migration file inside <code>db/migrate</code> directory. Snippet blow is one of remove column from table example generated by Rails generator,</p>

<pre><code>class RemoveAgeFromUsers &lt; ActiveRecord::Migration
  def up
    remove_column :users, :age
  end
  def down
    add_column :users, :age, :integer
  end
end
</code></pre>

<p>I also made a quick reference guide for Rails which can be found at <a href="http://blog.li-xinyang.com/2016/09/06/d-0000/" rel="noreferrer">here</a>. </p>
------------------------------------------------------------------ <br><h3> tenzin dorjee, Id: 57654438, Score: 5: </h3><p>Heres one more from rails console</p>

<p><code>ActiveRecord::Migration.remove_column(:table_name, :column_name)</code></p>
------------------------------------------------------------------ <br><h3> eden, Id: 15848647, Score: 10: </h3><pre><code>rails g migration RemoveXColumnFromY column_name:data_type
</code></pre>

<p>X = column name <br>
Y = table name</p>

<p><strong>EDIT</strong></p>

<p>Changed <code>RemoveXColumnToY</code> to <code>RemoveXColumnFromY</code> as per comments - provides more clarity for what the migration is actually doing.</p>
<h4> Sebastian vom Meer, Comment 28927250 Score: 3: </h4>&quot;Remove column <b>to</b> table&quot; sounds strange, so <b>from</b> seems to be the better choice here.<br><h4> BenKoshy, Comment 59967806 Score: 0: </h4>@SebastianvomMeer yes I concur - the English reads much better with &#39;from&#39;<br>------------------------------------------------------------------ <br><h3> Koresol, Id: 45733633, Score: 9: </h3><p>To remove the column from table you have to run following migration:</p>

<pre><code>rails g migration remove_column_name_from_table_name column_name:data_type
</code></pre>

<p>Then run command:</p>

<pre><code>rake db:migrate
</code></pre>
------------------------------------------------------------------ <br><h3> Dharmesh Rupani, Id: 36683787, Score: 6: </h3><p><code>remove_column</code> in <code>change</code> method will help you to delete the column from the table.</p>

<pre><code>class RemoveColumn &lt; ActiveRecord::Migration
  def change
    remove_column :table_name, :column_name, :data_type
  end
end
</code></pre>

<p>Go on this link for complete reference : <a href="http://guides.rubyonrails.org/active_record_migrations.html" rel="noreferrer">http://guides.rubyonrails.org/active_record_migrations.html</a></p>
------------------------------------------------------------------ <br><h3> Karan Bamniya, Id: 43250982, Score: 6: </h3><p>For removing column from table in just easy 3 steps as follows:</p>

<ol>
<li>write this command </li>
</ol>

<p><code>rails g migration remove_column_from_table_name</code></p>

<p>after running this command in terminal one file created by this name and time stamp (remove_column from_table_name).</p>

<p>Then go to this file.</p>

<ol start="2">
<li><p>inside file you have to write</p>

<p><code>remove_column :table_name, :column_name</code></p></li>
<li><p>Finally go to the console and then do</p>

<p><code>rake db:migrate</code></p></li>
</ol>
------------------------------------------------------------------ <br><h3> prash, Id: 21717780, Score: 5: </h3><p>Give below command it will add in migration file on its own</p>

<pre><code>rails g migration RemoveColumnFromModel
</code></pre>

<p>After running above command you can check migration file remove_column code must be added there on its own</p>

<p>Then migrate the db</p>

<pre><code>rake db:migrate
</code></pre>
------------------------------------------------------------------ <br><h3> H&#224; Tiến Đạt, Id: 69751839, Score: 5: </h3><p>Step 1: Create a migration</p>
<pre><code>  rails g migration remove_column_name_from_table
</code></pre>
<p>Step 2: Change code in file migration just created</p>
<p>rails version &lt; 3</p>
<pre><code>  def change
    remove_column :table_name, :column_name, :datatype
  end
</code></pre>
<p>rails version &gt;= 3</p>
<pre><code>  def change
    remove_column :table_name, :column_name
  end
</code></pre>
<p>Step 3: Migrate</p>
<pre><code>rake db:migrate
</code></pre>
<h4> fguillen, Comment 125011274 Score: 0: </h4>Simple and clear<br>------------------------------------------------------------------ <br><h3> Foram, Id: 54033894, Score: 2: </h3><p>Simply, You can remove column</p>

<pre><code>remove_column :table_name, :column_name
</code></pre>

<p>For Example,</p>

<pre><code>remove_column :posts, :comment
</code></pre>
------------------------------------------------------------------ <br><h3> Javad Moradi, Id: 59711014, Score: 2: </h3><p>first try to create a migration file running the command:</p>

<pre><code>rails g migration RemoveAgeFromUsers age:string
</code></pre>

<p>and then on the root directory of the project run the migration running the command:</p>

<pre><code>rails db:migrate
</code></pre>
------------------------------------------------------------------ <br><h3> Fernando Correia, Id: 67452215, Score: 2: </h3><ol>
<li>Mark the column as ignored in the model</li>
</ol>
<pre class="lang-rb prettyprint-override"><code>class MyModel &lt; ApplicationRecord
  self.ignored_columns = [&quot;my_field&quot;]
end
</code></pre>
<ol start="2">
<li>Generate a migration</li>
</ol>
<pre class="lang-sh prettyprint-override"><code>$ bin/rails g migration DropMyFieldFromMyModel
</code></pre>
<ol start="3">
<li>Edit the migration</li>
</ol>
<pre class="lang-rb prettyprint-override"><code>class DropMyFieldFromMyModel &lt; ActiveRecord::Migration[6.1]
  def change
    safety_assured { remove_column :my_table, :my_field }
  end
end
</code></pre>
<ol start="4">
<li>Run the migration</li>
</ol>
<pre class="lang-sh prettyprint-override"><code>$ bin/rails db:migrate
</code></pre>
------------------------------------------------------------------ <br><h3> Manh Cuong, Id: 42632600, Score: 1: </h3><p>Through<br>
<code>remove_column :table_name, :column_name</code><br>
in a migration file</p>

<p>You can remove a column directly in a rails console by typing:<br>
<code>ActiveRecord::Base.remove_column :table_name, :column_name</code></p>
------------------------------------------------------------------ <br><h3> Nuttapon, Id: 52270459, Score: 1: </h3><p>Do like this;</p>

<p><code>rails g migration RemoveColumnNameFromTables column_name:type</code></p>

<p>I.e. <code>rails g migration RemoveTitleFromPosts title:string</code></p>

<p>Anyway, Would be better to consider about downtime as well since the ActiveRecord caches database columns at runtime so if you drop a column, it might cause exceptions until your app reboots.</p>

<p>Ref: <a href="https://github.com/ankane/strong_migrations#removing-a-column" rel="nofollow noreferrer">Strong migration</a></p>
------------------------------------------------------------------ <br><h3> Waleed badar, Id: 73191620, Score: 0: </h3><p>you can use rails migration command</p>
<pre><code>rails generate migration RemoveColumnNameFromTableName column_name:column_type
</code></pre>
<p>than you can migrate the database:</p>
<pre><code>rails db:migrate
</code></pre>
------------------------------------------------------------------ <br><h3> Rahul Agarwal, Id: 68741656, Score: -1: </h3><p>Just run this in the rails console</p>
<pre><code>ActiveRecord::Base.connection.remove_column(&quot;table_name&quot;, :column_name, :its_data_type)
</code></pre>
<p>or</p>
<pre><code>TableName.find_by_sql(“ALTER TABLE table_name DROP column_name”)
</code></pre>
<h4> Paul Danelli, Comment 124434131 Score: 0: </h4>I&#39;m from the future and this is a terrible way to interact with your database.<br><h4> Jin Lim, Comment 130146161 Score: 0: </h4>why? is this not recommended? what if you want to do something from rails controller?<br>