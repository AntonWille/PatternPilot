 <h2> Title: Ruby: What does &#39;require: false&#39; in Gemfile mean? </h2> <h4> rafamvc, question_id: 4800721 </h4>Score: 487, Tags: {ruby,bundler,gemfile} <br><p>Does this: </p>

<pre><code>gem 'whenever', require: false
</code></pre>

<p>mean that the gem needs to be installed, or does it mean it is not required?</p>
<h4> Nakilon, Id: 91670133 Score: 1: </h4>Most of answers (including accepted one) are about Rails that do the <code>Bundler.require</code> by default as I understand. Only Ciro&#39;s and Nesha&#39;s answers are correct.<br>------------------------------------------------------------------ <br><h3> Rob Di Marco, Id: 4800746, Score: 522: </h3><p>This <a href="https://bundler.io/v2.3/man/gemfile.5.html#REQUIRE-AS" rel="noreferrer">means</a> install the gem, but do not call require when you start Bundler. So you will need to manually call</p>
<pre><code>require &quot;whenever&quot;
</code></pre>
<p>if you want to use the library.</p>
<p>If you were to do</p>
<pre><code>gem &quot;whenever&quot;, require: &quot;whereever&quot;
</code></pre>
<p>then bundler would download the gem named whenever, but would call</p>
<pre><code>require &quot;whereever&quot;
</code></pre>
<p>This is often used if the name of library to require is different than the name of the gem.</p>
<h4> Michael van Rooijen, Comment 15942297 Score: 137: </h4>@VenkatD. sometimes you want to install certain gems but you don&#39;t want to load them in to every process. I have a particular rake task that I want to invoke periodically on Heroku through their schedular add-on. This particular rake task requires certain gems that the rest of the application doensn&#39;t need. So I <code>:require =&gt; false</code> these particular gems and explicitly <code>require &quot;thegem&quot;</code> from the rake task. This would then save memory in the main app processes and startup time etc. App performance, however, should not be affected even if you require these additional gems in every process.<br><h4> Nathan Long, Comment 28642797 Score: 6: </h4>@MichaelvanRooijen - great points, however: &quot;App performance, however, should not be affected even if you require these additional gems in every process&quot;. I don&#39;t think that&#39;s true. Allocating objects takes work, and the GC has to run through all of them each time, so more = slower, according to <a href="http://confreaks.com/videos/2668-gogaruco2013-measuring-ruby" rel="nofollow noreferrer">confreaks.com/videos/2668-gogaruco2013-measuring-ruby</a><br><h4> Peter-Jan Celis, Comment 31413664 Score: 2: </h4>What if you want to set require to false and the library name is different to the gem name as well?<br><h4> Rob Di Marco, Comment 31435317 Score: 2: </h4>@Peter-JanCelis In that case you would just set <code>:require =&gt; false</code> and then in your code have a <code>require &#39;library_name_here&#39;</code><br><h4> Nathan Long, Comment 28815441 Score: 1: </h4>@MichaelvanRooijen - In practice, you&#39;re right, it won&#39;t generally matter unless you use the library. But requiring a gem will at least load its main file in lib, and probably it does more requires of its own. Even if you <code>require &#39;yaml&#39;</code>, you now have the <code>YAML</code> module as an object in memory.<br><h4> Michael van Rooijen, Comment 28812300 Score: 0: </h4>@NathanLong if you actually /use/ the gems. It depends on what you&#39;re doing. I was talking in the context of using <code>:require =&gt; false</code> or not. Even if you require the gem but don&#39;t actually instantiate objects it won&#39;t matter, and potentially only affects boot times to load the code base for that gem.  E.g. <code>Post.limit(100_000).map(&amp;:title)</code> destroys performance so you don&#39;t do this. However, these methods are available in memory. Instead you&#39;d do <code>Post.limit(100_000).pluck(:title)</code>.  I of course I agree that if you actually /use/ included gems, it would slow down.<br><h4> ErJab, Comment 23216893 Score: 0: </h4>&quot;This is often used if the name of library to require is different than the name of the gem.&quot; - Thanks! That helped me figure out why a gem I was using was not auto-required.<br><h4> Emeka, Comment 58919955 Score: 0: </h4>One such example is the guard-rspec gem, per the instructions you&#39;re supposed to include <code>gem &#39;guard-rspec&#39;, require: false</code> in the Guardfile, Per <a href="https://github.com/guard/guard-rspec" rel="nofollow noreferrer">github.com/guard/guard-rspec</a><br><h4> Chris Scott, Comment 70728709 Score: 0: </h4>Does this make any difference if I am declaring a gem in a Gemfile for a ruby script, where I have to manually require gems anyway?<br>------------------------------------------------------------------ <br><h3> gduq, Id: 4801057, Score: 84: </h3><p>You use <code>:require =&gt; false</code> when you want the gem to be installed but not "required". </p>

<p>So in the example you gave:
 <code>gem 'whenever', :require =&gt; false</code> 
when someone runs bundle install the whenever gem would be installed as with <code>gem install whenever</code>.  Whenever is used to create cron jobs by running a rake task but isn't usually used from within the rails (or other framework if not rails) application.</p>

<p>So you can use <code>:require =&gt; false</code> for anything that you need to run from the command line but don't need within your code.</p>
<h4> Nathan Long, Comment 28642769 Score: 8: </h4>This could also be used for a gem you only use in a small subset of requests.<br>------------------------------------------------------------------ <br><h3> Ciro Santilli OurBigBook.com, Id: 21045964, Score: 76: </h3><p><code>require: false</code> tells <code>Bundler.require</code> not to require that specific gem: the gem must be required explicitly via <code>require 'gem'</code>.</p>

<p>This option does <em>not</em> affect:</p>

<ul>
<li><p><code>bundle install</code>: the gem will get installed regardless</p></li>
<li><p>the <code>require</code> search path setup by bundler.</p>

<p>Bundler adds things to the path when you do either of:</p>

<ul>
<li><code>Bundle.setup</code></li>
<li>which is called by <code>require bundler/setup</code></li>
<li>which is called by <code>bundle exec</code></li>
</ul></li>
</ul>

<p><strong>Example</strong></p>

<p>Gemfile</p>

<pre><code>source 'https://rubygems.org'
gem 'haml'
gem 'faker', require: false
</code></pre>

<p>main.rb</p>

<pre><code># Fail because we haven't done Bundler.require yet.
# bundle exec does not automatically require anything for us,
# it only puts them in the require path.
begin Haml; rescue NameError; else raise; end
begin Faker; rescue NameError; else raise; end

# The Bundler object is automatically required on `bundle exec`.
Bundler.require

Haml
# Not required because of the require: false on the Gemfile.
# THIS is what `require: false` does.
begin Faker; rescue NameError; else raise; end

# Faker is in the path because Bundle.setup is done automatically
# when we use `bundle exec`. This is not affected by `require: false`.
require 'faker'
Faker
</code></pre>

<p>Then the following won't raise exceptions:</p>

<pre><code>bundle install --path=.bundle
bundle exec ruby main.rb
</code></pre>

<p><a href="https://github.com/cirosantilli/ruby-cheat/blob/23b71e388184da4aaf9a0c058043938e01b3d1fe/bundler/no_bundle_exec_me.rb" rel="noreferrer">On GitHub</a> for you to play with it.</p>

<p><strong>Rails usage</strong></p>

<p>As explained in the <a href="http://guides.rubyonrails.org/initialization.html" rel="noreferrer">initialization tutorial</a>, the default Rails template runs on startup:</p>

<ul>
<li><code>config/boot.rb</code></li>
<li><code>config/application.rb</code></li>
</ul>

<p><code>config/boot.rb</code> contains:</p>

<pre><code>ENV['BUNDLE_GEMFILE'] ||= File.expand_path('../../Gemfile', __FILE__)
require 'bundler/setup' if File.exists?(ENV['BUNDLE_GEMFILE'])
</code></pre>

<p>which does the <code>require 'bundler/setup'</code> and sets up the require path.</p>

<p><code>config/application.rb</code> does:</p>

<pre><code>Bundler.require(:default, Rails.env)
</code></pre>

<p>which actually requires the gems.</p>
<h4> rellampec, Comment 135111765 Score: 0: </h4>Although not specified in the docs, while <a href="https://www.rubydoc.info/github/bundler/bundler/Bundler.setup" rel="nofollow noreferrer">Bundler::setup</a> does a &quot;cut&quot; of the available gems (specified in the groups), <a href="https://www.rubydoc.info/github/bundler/bundler/Bundler.require" rel="nofollow noreferrer">Bundler::require</a> (on specific groups) seems to be the one that actually installs the path to the gem (it also does the cut, if <code>setup</code> was not called previously). So <code>Bundler::require</code> should be called regardless if <code>required: false</code> was specified in the <i>Gemfile</i> (otherwise a <code>LoadError</code> will follow when calling <code>require &#39;gem-name&#39;</code>)<br><h4> dazonic, Comment 53635228 Score: 0: </h4>Note that using <code>require &#39;faker</code> might not use the correct gem version, specifically if you&#39;re Gemfile points to a git ref.<br><h4> Ciro Santilli OurBigBook.com, Comment 53635284 Score: 0: </h4>@dazonic is Haml any different on the example?<br>------------------------------------------------------------------ <br><h3> Subhash Chandra, Id: 35646481, Score: 19: </h3><p>Whenever you specify a Gem in your <code>Gemfile</code> and run<code> bundle install</code>, bundler will go and install specified gem and load code for that Gem in you app by putting  <code>require 'whenever'</code> this way bundler will load code for all of your Gems in your Rails app, and you can call any method from any Gem without any pain, like you do most of the time.</p>

<p>but Gems like <code>whenever, faker or capistrano </code> are something which you do not need in your app code you need whenever code in your <code>schedule.rb </code> file to manage crons and capistrano code in <code>deploy.rb </code> file to customize deployment recipe so you need not to load code for these gems in your app code 
and wherever you want to call any method from these Gems you can manually require thsese gems by yourself by putting <code> require "whenever" </code>. so you put <code>:require => false</code> in your Gemfile for these Gems, this way bundler will install that Gem but not load code for that Gem itself, you can do it whenever you want by simply putting like require 'whenever' in your case.</p>
------------------------------------------------------------------ <br><h3> BenKoshy, Id: 69997344, Score: 6: </h3><h3>Analogy to Explain</h3>
<pre><code>## Gemfile
gem &quot;university_degree&quot;, require: false
gem &quot;dealing_with_boss&quot; 
</code></pre>
<ul>
<li><p>&quot;<code>dealing_with_boss</code>&quot; - loaded into memory and ready to go.</p>
</li>
<li><p><code>degree gem</code> - not &quot;needed&quot;....you need to manually <code>require</code> it, in order to use it.</p>
</li>
</ul>
------------------------------------------------------------------ <br><h3> Nesha Zoric, Id: 49197065, Score: 2: </h3><p>In order to require gems in your Gemfile, you will need to call <code>Bundler.require</code>. </p>

<p>You can prevent bundler from requiring the gem with <code>require: false</code>, but it will still install and maintain the gem. Check <a href="https://kolosek.com/rails-bundle-install-and-gemfile" rel="nofollow noreferrer">this out</a> for a more detailed explanation.</p>
