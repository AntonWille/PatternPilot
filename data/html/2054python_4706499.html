 <h2> Title: How do I append to a file? </h2> <h3> user502039, question_id: 4706499 </h3>Score: 2054, Tags: {python,file,append} <br><p>How do I append to a file instead of overwriting it?</p>
------------------------------------------------------------------ <br><h3> Answer 4706520 Petter: </h3><p>Set the mode in <a href="https://docs.python.org/3/library/functions.html#open" rel="noreferrer"><code>open()</code></a> to <code>&quot;a&quot;</code> (append) instead of <code>&quot;w&quot;</code> (write):</p>
<pre class="lang-py prettyprint-override"><code>with open(&quot;test.txt&quot;, &quot;a&quot;) as myfile:
    myfile.write(&quot;appended text&quot;)
</code></pre>
<p>The <a href="https://docs.python.org/3/library/functions.html#open" rel="noreferrer">documentation</a> lists all the available modes.</p>
<h4> Comment 24726149 Petter: </h4>bluewoodtree: The benefits are similar to that of RAII in C++. If you forget close(), it might take a while before the file is actually closed. It is easier that you might think to forget it when the code has multiple exit points, exceptions and so on.<br><h4> Comment 8186823 Dan: </h4><a href="http://docs.python.org/tutorial/inputoutput.html" rel="nofollow noreferrer">This</a> from the tutorial may be useful as well.<br><h4> Comment 111515073 Brian: </h4>There is a functional difference besides just remembering to close. <code>with</code> opens a context manager which will close the file even if there is an error between opening and <code>close()</code>.<br><h4> Comment 116497923 Timo: </h4>One could easy do <code>with open(&quot;test.txt&quot;) as myfile: myfile.write(&quot;appended text&quot;,&#39;a&#39;)</code>, but a is needed in open.<br><h4> Comment 120653863 ー PupSoZeyDe ー: </h4>@Timo TypeError: TextIOWrapper.write() takes exactly one argument (2 given)<br><h4> Comment 127225777 Daniel: </h4>This might be useful if you want to write to a new line each time.  <a href="https://stackoverflow.com/a/33591893/6749790">stackoverflow.com/a/33591893/6749790</a><br>------------------------------------------------------------------ <br><h3> Answer 4706519 sinelaw: </h3><p>You need to open the file in append mode, by setting "a" or "ab" as the mode. See <em><a href="https://docs.python.org/2/library/functions.html#open" rel="noreferrer">open()</a></em>.</p>

<p>When you open with "a" mode, the write position will <strong>always</strong> be at the end of the file (an append). You can open with "a+" to allow reading, seek backwards and read (but all writes will still be at the end of the file!).</p>

<p>Example:</p>

<pre><code>&gt;&gt;&gt; with open('test1','wb') as f:
        f.write('test')
&gt;&gt;&gt; with open('test1','ab') as f:
        f.write('koko')
&gt;&gt;&gt; with open('test1','rb') as f:
        f.read()
'testkoko'
</code></pre>

<p><strong>Note</strong>: Using 'a' is not the same as opening with 'w' and seeking to the end of the file - consider what might happen if another program opened the file and started writing between the seek and the write. On some operating systems, opening the file with 'a' guarantees that all your following writes will be appended atomically to the end of the file (even as the file grows by other writes).</p>

<hr>

<p>A few more details about how the "a" mode operates (<em>tested on Linux only</em>). Even if you seek back, every write will append to the end of the file:</p>

<pre><code>&gt;&gt;&gt; f = open('test','a+') # Not using 'with' just to simplify the example REPL session
&gt;&gt;&gt; f.write('hi')
&gt;&gt;&gt; f.seek(0)
&gt;&gt;&gt; f.read()
'hi'
&gt;&gt;&gt; f.seek(0)
&gt;&gt;&gt; f.write('bye') # Will still append despite the seek(0)!
&gt;&gt;&gt; f.seek(0)
&gt;&gt;&gt; f.read()
'hibye'
</code></pre>

<p>In fact, the <code>fopen</code> <a href="http://www.manpagez.com/man/3/fopen/" rel="noreferrer">manpage</a> states:</p>

<blockquote>
  <p>Opening a file in append mode (a as the first character of mode)
  causes all subsequent write operations to this stream to occur at
  end-of-file, as if preceded the call:</p>

<pre><code>fseek(stream, 0, SEEK_END);
</code></pre>
</blockquote>

<hr>

<h3>Old simplified answer (not using <code>with</code>):</h3>

<p>Example: (<em>in a real program <strong>use <code>with</code> to close the file</strong> - see <a href="http://docs.python.org/2/whatsnew/2.6.html#pep-343-the-with-statement" rel="noreferrer">the documentation</a></em>)</p>

<pre><code>&gt;&gt;&gt; open("test","wb").write("test")
&gt;&gt;&gt; open("test","a+b").write("koko")
&gt;&gt;&gt; open("test","rb").read()
'testkoko'
</code></pre>
<h4> Comment 123141590 Rick Moritz: </h4>So this implies, that multiple handles can be held across multiple processes, without any write conflicts?<br>------------------------------------------------------------------ <br><h3> Answer 46980522 Cleve Green: </h3><p>Python has many variations off of the main three modes, these three modes are:</p>

<pre><code>'w'   write text
'r'   read text
'a'   append text
</code></pre>

<p>So to append to a file it's as easy as:</p>

<pre><code>f = open('filename.txt', 'a') 
f.write('whatever you want to write here (in append mode) here.')
</code></pre>

<p>Then there are the modes that just make your code fewer lines:</p>

<pre><code>'r+'  read + write text
'w+'  read + write text
'a+'  append + read text
</code></pre>

<p>Finally, there are the modes of reading/writing in binary format: </p>

<pre><code>'rb'  read binary
'wb'  write binary
'ab'  append binary
'rb+' read + write binary
'wb+' read + write binary
'ab+' append + read binary
</code></pre>
------------------------------------------------------------------ <br><h3> Answer 26833243 Seth Connell: </h3><p>I always do this,</p>

<pre><code>f = open('filename.txt', 'a')
f.write("stuff")
f.close()
</code></pre>

<p>It's simple, but very useful.</p>
<h4> Comment 44929032 Sam Redway: </h4>its a little nicer and a little bit safer to write: with open(&#39;filename&#39;,&#39;a&#39;) as f: f.write(&#39;stuff&#39;)<br>------------------------------------------------------------------ <br><h3> Answer 4706565 istruble: </h3><p>You probably want to pass <code>"a"</code> as the mode argument.  See the docs for <a href="http://docs.python.org/library/functions.html#open" rel="noreferrer">open()</a>.</p>

<pre><code>with open("foo", "a") as f:
    f.write("cool beans...")
</code></pre>

<p>There are other permutations of the mode argument for updating (+), truncating (w) and binary (b) mode but starting with just <code>"a"</code> is your best bet.</p>
<h4> Comment 5195504 Mark Tolonen: </h4><code>file</code> shadows a built-in function.  Don&#39;t use it for variables.<br><h4> Comment 43779799 jfs: </h4>@MarkTolonen: <code>file</code> is no longer a builtin in Python 3. <a href="http://stackoverflow.com/a/11942631/4279">Even in Python 2, it is used very rarely</a>. Opening a file is a common operation. It is ok to use <code>file</code> name here on both Python 2 and 3. <a href="https://www.python.org/dev/peps/pep-0008/#a-foolish-consistency-is-the-hobgoblin-of-little-minds" rel="nofollow noreferrer">Know when to be inconsistent.</a><br>------------------------------------------------------------------ <br><h3> Answer 59703557 Alaa M.: </h3><p>You can also do it with <code>print</code> instead of <code>write</code>:</p>

<pre><code>with open('test.txt', 'a') as f:
    print('appended text', file=f)
</code></pre>

<p>If <strong>test.txt</strong> doesn't exist, it will be created...</p>
------------------------------------------------------------------ <br><h3> Answer 41382974 K.Suthagar: </h3><p>when we using this line <code>open(filename, "a")</code>, that <code>a</code> indicates the appending the file, that means allow to insert extra data to the existing file.</p>

<p>You can just use this following lines to append the text in your file</p>

<pre><code>def FileSave(filename,content):
    with open(filename, "a") as myfile:
        myfile.write(content)

FileSave("test.txt","test1 \n")
FileSave("test.txt","test2 \n")
</code></pre>
------------------------------------------------------------------ <br><h3> Answer 54584404 Primusa: </h3><p>You can also open the file in <code>r+</code> mode and then set the file position to the end of the file.</p>

<pre><code>import os

with open('text.txt', 'r+') as f:
    f.seek(0, os.SEEK_END)
    f.write("text to add")
</code></pre>

<p>Opening the file in <code>r+</code> mode will let you write to other file positions besides the end, while <code>a</code> and <code>a+</code> force writing to the end.</p>
------------------------------------------------------------------ <br><h3> Answer 56301530 Alec: </h3><p>The <code>'a'</code> parameter signifies append mode. If you don't want to use <code>with open</code> each time, you can easily write a function to do it for you:</p>

<pre><code>def append(txt='\nFunction Successfully Executed', file):
    with open(file, 'a') as f:
        f.write(txt)
</code></pre>

<p>If you want to write somewhere else other than the end, you can use <code>'r+'</code><sup>†</sup>:</p>

<pre><code>import os

with open(file, 'r+') as f:
    f.seek(0, os.SEEK_END)
    f.write("text to add")
</code></pre>

<p>Finally, the <code>'w+'</code> parameter grants even more freedom. Specifically, it allows you to create the file if it doesn't exist, as well as empty the contents of a file that currently exists.</p>

<hr>

<p><sup>†</sup> <a href="https://stackoverflow.com/a/54584404/7583953">Credit for this function goes to @Primusa</a></p>
------------------------------------------------------------------ <br><h3> Answer 53862966 nima moradi: </h3><p>if you want to append to a file </p>

<pre><code>with open("test.txt", "a") as myfile:
    myfile.write("append me")
</code></pre>

<p>We declared the variable <code>myfile</code> to open a file named <code>test.txt</code>. Open takes 2 arguments, the file that we want to open and a string that represents the kinds of permission or operation we want to do on the file<br></p>

<p>here is file mode options</p>

<pre>
Mode    Description

'r' This is the default mode. It Opens file for reading.
'w' This Mode Opens file for writing. 
If file does not exist, it creates a new file.
If file exists it truncates the file.
'x' Creates a new file. If file already exists, the operation fails.
'a' Open file in append mode. 
If file does not exist, it creates a new file.
't' This is the default mode. It opens in text mode.
'b' This opens in binary mode.
'+' This will open a file for reading and writing (updating)
</pre>
------------------------------------------------------------------ <br><h3> Answer 64081807 Walt Howard: </h3><p><em><strong>If multiple processes are writing to the file</strong></em>, you must use append mode or the data will be scrambled. Append mode will make the operating system put every write, at the end of the file irrespective of where the writer thinks his position in the file is. This is a common issue for multi-process services like nginx or apache where multiple instances of the same process, are writing to the same log
file. Consider what happens if you try to seek, then write:</p>
<pre><code>Example does not work well with multiple processes: 

f = open(&quot;logfile&quot;, &quot;w&quot;); f.seek(0, os.SEEK_END); f.write(&quot;data to write&quot;);

writer1: seek to end of file.           position 1000 (for example)
writer2: seek to end of file.           position 1000
writer2: write data at position 1000    end of file is now 1000 + length of data.
writer1: write data at position 1000    writer1's data overwrites writer2's data.
</code></pre>
<p>By using append mode, the operating system will place any write at the end of the file.</p>
<pre><code>f = open(&quot;logfile&quot;, &quot;a&quot;); f.seek(0, os.SEEK_END); f.write(&quot;data to write&quot;);
</code></pre>
<p>Append most does <strong>not</strong> mean, &quot;open file, go to end of the file once after opening it&quot;. It means, &quot;open file, every write I do will be at the end of the file&quot;.</p>
<p>WARNING: For this to work you must write all your record in one shot, in one write call. If you split the data between multiple writes, other writers can and will get their writes in between yours and mangle your data.</p>
------------------------------------------------------------------ <br><h3> Answer 59309810 mattc-7: </h3><p>The simplest way to append more text to the end of a file would be to use:</p>

<pre><code>with open('/path/to/file', 'a+') as file:
    file.write("Additions to file")
file.close()
</code></pre>

<p>The <code>a+</code> in the <code>open(...)</code> statement instructs to open the file in append mode and allows read and write access.</p>

<p>It is also always good practice to use <code>file.close()</code> to close any files that you have opened once you are done using them.</p>
<h4> Comment 107607829 Erik Knowles: </h4>&quot;file.close&quot; is automatically called at the end of the &quot;with&quot; block, which is the advantage of the keyword.  Also, the OP asked about opening a file for appending. The &quot;+&quot; mode isn&#39;t necessary unless you want to read as well.<br>------------------------------------------------------------------ <br><h3> Answer 74118831 Karl Knechtel: </h3><p>Sometimes, beginners have this problem because they attempt to open and write to a file in a loop:</p>
<pre class="lang-py prettyprint-override"><code>for item in my_data:
    with open('results.txt', 'w') as f:
        f.write(some_calculation(item))
</code></pre>
<p>The problem is that <strong>every time the file is opened for writing, it will be truncated (cleared out)</strong>.</p>
<p>We <em>can</em> solve this by opening in append mode instead; but in cases like this, it will normally be better to solve the problem by <em>inverting the logic</em>. If the file is opened only once, then it won't get overwritten each time; and we can keep writing to it <em>as long as it is open</em> - we don't have to re-open it for each <code>write</code> (it would be pointless for Python to make things work that way, since it would add to the required code for no benefit).</p>
<p>Thus:</p>
<pre><code>with open('results.txt', 'w') as f:
    for item in my_data:
        f.write(some_calculation(item))
</code></pre>
<h4> Comment 132192242 crasu: </h4>This is not really answering the question.<br><h4> Comment 132194757 Karl Knechtel: </h4>I wrote it because this Q&amp;A sometimes gets used as a duplicate when beginners have a debugging question caused by this issue.<br>