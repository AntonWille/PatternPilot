 <h2> Title: Checking if a variable is defined? </h2> <h4> readonly, question_id: 288715, created_at: 2008-11-13 23:14:05+00:00 </h4>Score: 611, Tags: {ruby,reflection} <br><p>How can I check whether a variable is defined in Ruby?  Is there an <code>isset</code>-type method available?</p>
<hr><h3> ✔️ Answer by Ricardo Acras, Id: 288726, Score: 818, created_at: 2008-11-13 23:22:27+00:00 </h3><p>Use the <code>defined?</code> keyword (<a href="http://ruby-doc.org/docs/keywords/1.9/Object.html#method-i-defined-3F" rel="noreferrer">documentation</a>). It will return a String with the kind of the item, or <code>nil</code> if it doesn’t exist.</p>

<pre><code>&gt;&gt; a = 1
 =&gt; 1
&gt;&gt; defined? a
 =&gt; "local-variable"
&gt;&gt; defined? b
 =&gt; nil
&gt;&gt; defined? nil
 =&gt; "nil"
&gt;&gt; defined? String
 =&gt; "constant"
&gt;&gt; defined? 1
 =&gt; "expression"
</code></pre>

<p>As skalee commented: "It is worth noting that variable which is set to nil is initialized."</p>

<pre><code>&gt;&gt; n = nil  
&gt;&gt; defined? n
 =&gt; "local-variable"
</code></pre>
<h4> Comment by jrdioko, Score: 7, Id: 7889258, created_at: 2011-07-12 21:29:23+00:00 </h4>If you want to set a variable if it doesn&#39;t exist and leave it alone if it does, see @danmayer&#39;s answer (involving the <code>||=</code> operator) below.<h4> Comment by elsurudo, Score: 2, Id: 65479765, created_at: 2016-08-21 15:02:53+00:00 </h4>Here&#39;s another oddity I can into.. If you define a variable in an if-block for which the condition is never met, <code>defined?</code> still returns true for a variable defined within that block!<h4> Comment by stevec, Score: 2, Id: 100227916, created_at: 2019-07-01 14:45:29+00:00 </h4>Is there a method like <code>defined?</code> that returns boolean?<h4> Comment by stevec, Score: 0, Id: 100229295, created_at: 2019-07-01 15:31:40+00:00 </h4>To return true/false, <code>!!defined?(object_name)</code><h4> Comment by Andre Figueiredo, Score: 0, Id: 104387628, created_at: 2019-11-27 16:58:24+00:00 </h4>@jrdioko it&#39;s not the same, i.e. setter returns false value like <code>nil</code> or <code>false</code>, defeating the purpose of caching value in instance variable, and doing all reassigning again, with god-knows-what will be executed..<hr><h3>  Answer by danmayer, Id: 288729, Score: 95, created_at: 2008-11-13 23:23:32+00:00 </h3><p>This is useful if you want to do nothing if it does exist but create it if it doesn't exist.</p>

<pre><code>def get_var
  @var ||= SomeClass.new()
end
</code></pre>

<p>This only creates the new instance once. After that it just keeps returning the var.</p>
<h4> Comment by Andrew Marshall, Score: 39, Id: 13806136, created_at: 2012-05-18 06:27:07+00:00 </h4>Just don&#39;t use <code>||=</code> with boolean values, lest you feel the pain of confusion.<h4> Comment by jrdioko, Score: 9, Id: 7889238, created_at: 2011-07-12 21:28:33+00:00 </h4>This is very idiomatic Ruby too and very typical, by the way.<h4> Comment by nzifnab, Score: 6, Id: 18417224, created_at: 2012-11-19 23:58:52+00:00 </h4>along with what @AndrewMarshall said, avoid this idiom with anything that might return <code>nil</code> as well unless you <i>really</i> want to evaluate the expression every time it&#39;s called when it does return <code>nil</code><h4> Comment by Tony Zito, Score: 1, Id: 40612268, created_at: 2014-09-19 19:20:59+00:00 </h4>If you <i>are</i> working with booleans, and want the default value to be true if the variable wasn&#39;t explicitly set to false, you can use this construction:  <code>var = (var or var.nil?)</code><h4> Comment by anon, Score: 1, Id: 59416528, created_at: 2016-03-08 19:42:38+00:00 </h4>@ArnaudMeuret <a href="http://stackoverflow.com/a/2505285/1863564">Sort of, not really.</a> -- while it may not seem identical, it&#39;s worth reading the answers on that question.<h4> Comment by Yoshi, Score: 0, Id: 55883548, created_at: 2015-12-03 11:49:39+00:00 </h4><code>||=</code> will not work for boolean <code>false</code>. let&#39;s say  <code>a = false</code> <code>a ||= true</code> then <code>a == true</code> you should use <code>defined? a</code> for boolean case<h4> Comment by Pierre-Adrien, Score: 0, Id: 9837383, created_at: 2011-11-07 10:35:35+00:00 </h4>Thanks for this input ! I&#39;m a ruby/rails beginner and came accross this syntax yesterday evening, had a hard time figuring out what it meant. Looks very handy !<h4> Comment by Ghoti, Score: 0, Id: 30469910, created_at: 2013-12-05 15:32:30+00:00 </h4>Personally don&#39;t like methods with get_ on the front (hey it&#39;s not Java :)), I&#39;d just call it &quot;var&quot; and expose it to the outside world that way. I do this a lot to hide @variables and default them without having to jump through lots of hoops. get_ feels very procedural, you might want to do all sorts of things in that method one day.<h4> Comment by Arnaud Meuret, Score: 0, Id: 39898311, created_at: 2014-08-28 14:42:49+00:00 </h4>No magic here. Mere syntactic sugar for <code>@var = @var || SomeClass.new</code>. Just unroll any Ruby <code>..=</code> operator if you&#39;re having difficulties wrapping your mind around it (and this is completely unrelated do <code>defined?</code> BTW). No layman rubyist should use <code>defined?</code> anyway.<hr><h3>  Answer by foomip, Id: 6152507, Score: 71, created_at: 2011-05-27 12:54:07+00:00 </h3><p>The correct syntax for the above statement is:</p>

<pre><code>if (defined?(var)).nil? # will now return true or false
 print "var is not defined\n".color(:red)
else
 print "var is defined\n".color(:green)
end
</code></pre>

<p>substituting (<code>var</code>) with your variable. This syntax will return a true/false value for evaluation in the if statement.</p>
<h4> Comment by Jerome, Score: 11, Id: 12828805, created_at: 2012-04-05 14:23:01+00:00 </h4>That&#39;s not necessary as nil evaluates to false when used in a test<h4> Comment by vol7ron, Score: 0, Id: 23129250, created_at: 2013-04-23 22:17:43+00:00 </h4>Why not <code>defined?(var) == nil</code> ?<h4> Comment by juanpaco, Score: 0, Id: 29104093, created_at: 2013-10-26 13:05:42+00:00 </h4>@vol7ron - That is perfectly valid syntax.  Using the call to <code>.nil?</code> is more idiomatic, as they say.  It&#39;s more &quot;object-oriented&quot; to ask an object if it <code>nil</code> than to use a comparison operator.  Neither is difficult to read, so use whichever one helps you ship more product.<h4> Comment by Arnaud Meuret, Score: 0, Id: 39898481, created_at: 2014-08-28 14:46:20+00:00 </h4>Which statement are you refering to ?!? Don&#39;t use an answer as a comment to something else.<hr><h3>  Answer by digitalsanctum, Id: 288724, Score: 19, created_at: 2008-11-13 23:18:45+00:00 </h3><p><code>defined?(your_var)</code> will work. Depending on what you're doing you can also do something like <code>your_var.nil?</code></p>
<h4> Comment by Gobol, Score: 29, Id: 27553128, created_at: 2013-09-09 15:45:29+00:00 </h4><code>your_var.nil?</code> will result in error : <code>undefined local variable or method your_var</code> when not defined before...<h4> Comment by kakubei, Score: 0, Id: 25687622, created_at: 2013-07-14 16:15:09+00:00 </h4>+1 for <code>your_var.nil?</code> because it returns true of false and is much nicer to read and write than <code>defined? var</code>. Thanks for this.<hr><h3>  Answer by user761856, Id: 10049018, Score: 16, created_at: 2012-04-06 20:42:16+00:00 </h3><p>Try "unless" instead of "if"</p>

<pre><code>a = "apple"
# Note that b is not declared
c = nil

unless defined? a
    puts "a is not defined"
end

unless defined? b
    puts "b is not defined"
end

unless defined? c
    puts "c is not defined"
end
</code></pre>
<h4> Comment by look, Score: 2, Id: 15829152, created_at: 2012-08-09 22:54:24+00:00 </h4>It very nicely answers the question in one more useful way, doesn&#39;t it?<h4> Comment by ChrisPhoenix, Score: 2, Id: 27717689, created_at: 2013-09-13 22:19:48+00:00 </h4>The ruby style guide says &quot;Favor unless over if for negative conditions&quot; <a href="https://github.com/bbatsov/ruby-style-guide" rel="nofollow noreferrer">github.com/bbatsov/ruby-style-guide</a><h4> Comment by Andrew Grimm, Score: 0, Id: 14119082, created_at: 2012-05-31 22:54:23+00:00 </h4>What does this answer add that hasn&#39;t been said by the other answers?<hr><h3>  Answer by BenKoshy, Id: 44982213, Score: 12, created_at: 2017-07-08 03:31:29+00:00 </h3><h3>WARNING Re: A Common Ruby Pattern</h3>
<p>the <code>defined?</code> method is the answer. <a href="https://stackoverflow.com/a/288726/4880924">See the accepted answer above</a>.</p>
<p><em><strong>But watch out...</strong></em> consider this common ruby pattern:</p>
<pre><code> def method1
    @x ||= method2
 end

 def method2
    nil
 end
</code></pre>
<ol>
<li><code>method2</code> always returns <code>nil</code>.</li>
<li>The first time you call <code>method1</code>, the <code>@x</code> variable is not set - therefore <code>method2</code> will be run. and</li>
<li><code>method2</code> will set <code>@x</code> to <code>nil</code>.</li>
</ol>
<p>But what happens the second time you call <code>method1</code>?</p>
<p>Remember @x has already been set to nil. But <code>method2</code> will still be run again!! If method2 is a costly undertaking this might not be something that you want.</p>
<p>Let the <code>defined?</code> method come to the rescue:</p>
<pre><code>  def method1
    return @x if defined? @x
    @x = method2
  end
</code></pre>
<p>As with most things, the devil is in the implementation details.</p>
<h4> Comment by Kulgar, Score: 0, Id: 105726524, created_at: 2020-01-17 17:25:37+00:00 </h4>You are totally right, thank you for highlighting that specific caveat<hr><h3>  Answer by Saqib R., Id: 16238957, Score: 10, created_at: 2013-04-26 14:30:15+00:00 </h3><p>Use <code>defined? YourVariable</code><br>
<strong><em>Keep it simple silly</em></strong> .. ;)</p>
<hr><h3>  Answer by Bruno Barros, Id: 9728836, Score: 6, created_at: 2012-03-15 22:00:25+00:00 </h3><p>You can try:</p>

<pre><code>unless defined?(var)
  #ruby code goes here
end
=&gt; true
</code></pre>

<p>Because it returns a boolean.</p>
<h4> Comment by Andrew Grimm, Score: 0, Id: 15658664, created_at: 2012-08-02 23:11:56+00:00 </h4><code>SyntaxError: compile error (irb):2: syntax error, unexpected $end, expecting kEND</code><h4> Comment by johannes, Score: 0, Id: 17835988, created_at: 2012-10-29 08:38:43+00:00 </h4>to use an <code>unless</code> statement seems overly complicated<h4> Comment by Cadoiz, Score: 0, Id: 133907528, created_at: 2023-04-03 12:02:25+00:00 </h4><code>defined?</code> does <b>NOT</b> return a boolean, but the type of what comes afterwards. This type can be truthy or falsy, but you should pay attention. The <code>=&gt; true</code> is misleading at best unless your &quot;<code>#ruby code </code>&quot; that &quot;<code>goes here</code>&quot; returns <code>true</code>.<hr><h3>  Answer by Sardathrion - against SE abuse, Id: 3724712, Score: 8, created_at: 2010-09-16 07:52:27+00:00 </h3><p>Here is some code, nothing rocket science but it works well enough</p>

<pre><code>require 'rubygems'
require 'rainbow'
if defined?(var).nil?  # .nil? is optional but might make for clearer intent.
 print "var is not defined\n".color(:red)
else
 print "car is defined\n".color(:green)
end
</code></pre>

<p>Clearly, the colouring code is not necessary, just a nice visualation in this toy example.</p>
<h4> Comment by James, Score: 0, Id: 14515836, created_at: 2012-06-18 16:15:07+00:00 </h4>Presumably because the <code>nil?</code> is optional.<hr><h3>  Answer by donnoman, Id: 41532508, Score: 5, created_at: 2017-01-08 12:07:38+00:00 </h3><p>As many other examples show you don't actually need a boolean from a method to make logical choices in ruby. It would be a poor form to coerce everything to a boolean unless you actually need a boolean. </p>

<p>But if you absolutely need a boolean. Use !! (bang bang) or "falsy falsy reveals the truth".</p>

<pre><code>› irb
&gt;&gt; a = nil
=&gt; nil
&gt;&gt; defined?(a)
=&gt; "local-variable"
&gt;&gt; defined?(b)
=&gt; nil
&gt;&gt; !!defined?(a)
=&gt; true
&gt;&gt; !!defined?(b)
=&gt; false
</code></pre>

<p>Why it doesn't usually pay to coerce:</p>

<pre><code>&gt;&gt; (!!defined?(a) ? "var is defined".colorize(:green) : "var is not defined".colorize(:red)) == (defined?(a) ? "var is defined".colorize(:green) : "var is not defined".colorize(:red))
=&gt; true
</code></pre>

<p>Here's an example where it matters because it relies on the implicit coercion of the boolean value to its string representation.</p>

<pre><code>&gt;&gt; puts "var is defined? #{!!defined?(a)} vs #{defined?(a)}"
var is defined? true vs local-variable
=&gt; nil
</code></pre>
<hr><h3>  Answer by leberknecht, Id: 45691059, Score: 3, created_at: 2017-08-15 10:28:12+00:00 </h3><p>It  should be mentioned that using <code>defined</code> to check if a specific field is set in a hash might behave unexpected:</p>

<pre><code>var = {}
if defined? var['unknown']
  puts 'this is unexpected'
end
# will output "this is unexpected"
</code></pre>

<p>The syntax is correct here, but <code>defined? var['unknown']</code> will be evaluated to the string <code>"method"</code>, so the <code>if</code> block will be executed</p>

<p>edit: The correct notation for checking if a key exists in a hash would be:</p>

<pre><code>if var.key?('unknown')
</code></pre>
<hr><h3>  Answer by Robert Klemme, Id: 27445810, Score: 2, created_at: 2014-12-12 14:30:07+00:00 </h3><p>Please note the distinction between "defined" and "assigned".</p>

<pre><code>$ ruby -e 'def f; if 1&gt;2; x=99; end;p x, defined? x; end;f'
nil
"local-variable"
</code></pre>

<p>x is defined even though it is never assigned!</p>
<h4> Comment by Paul Pettengill, Score: 0, Id: 53340403, created_at: 2015-09-23 21:34:10+00:00 </h4>This is something I just came across.  I was expecting <code>NameError Exception: undefined local variable or method</code>, and was confused when the only assignment/mention of the variable was in an if block that wasn&#39;t getting hit.<hr><h3>  Answer by John Donner, Id: 50395751, Score: 2, created_at: 2018-05-17 15:52:41+00:00 </h3><p><code>defined?</code> is great, but if you are in a Rails environment you can also use <code>try</code>, especially in cases where you want to check a dynamic variable name:</p>

<pre><code>foo = 1
my_foo = "foo"
my_bar = "bar"
try(:foo)        # =&gt; 1
try(:bar)        # =&gt; nil
try(my_foo)      # =&gt; 1
try(my_bar)      # =&gt; nil
</code></pre>
<h4> Comment by Ramses, Score: 0, Id: 126355254, created_at: 2022-03-15 20:57:59+00:00 </h4>this is exactly what I was looking for. I need the value if the var exists.Thanks!<hr><h3>  Answer by Elliott, Id: 33307520, Score: 0, created_at: 2015-10-23 16:45:04+00:00 </h3><p>Also, you can check if it's defined while in a string via interpolation, if you code: </p>

<pre><code>puts "Is array1 defined and what type is it? #{defined?(@array1)}"
</code></pre>

<p>The system will tell you the type if it is defined.
If it is not defined it will just return a warning saying the variable is not initialized.</p>

<p>Hope this helps! :)</p>
<hr><h3>  Answer by stevec, Id: 66048871, Score: 0, created_at: 2021-02-04 15:38:54+00:00 </h3><p>Leaving an incredibly simple example in case it helps.</p>
<p>When variable <strong>doesn't exist</strong>:</p>
<pre><code>if defined? a then &quot;hi&quot; end
# =&gt; nil
</code></pre>
<p>When variable <strong>does exist</strong>:</p>
<pre class="lang-rb prettyprint-override"><code>a = 2
if defined? a then &quot;hi&quot; end
# =&gt; &quot;hi&quot;
</code></pre>
